# ×”×§×©×¨ ×¤×¢×™×œ - Phi (Ï†)

## ××™×§×•× × ×•×›×—×™ ×‘×¤×¨×•×™×§×˜

### ğŸ‰ **×¢×“×›×•×Ÿ ××—×¨×•×Ÿ: 31 ×‘×“×¦××‘×¨ 2025**

**Phase 1 + 1.5 + 2 ××•×©×œ××™×!** ××¢×¨×›×ª ×”×¡×™×•×•×’ ×¢×•×‘×“×ª ××¦×•×™×Ÿ ×¢× ×’×¨×¤×™×, ×œ××™×“×” ××”××©×ª××©, ×•×¤×§×•×“×•×ª ×¢×–×¨×”.

---

## ğŸ“± ×¢×§×¨×•×Ÿ ××¤×ª×—: WhatsApp-First

> **×”×“×¡×§×˜×•×¤ ×œ×¦×¤×™×™×” ×‘×œ×‘×“. ×›×œ ×”×¤×¢×•×œ×•×ª ×“×¨×š WhatsApp.**

| ×××©×§ | ×ª×¤×§×™×“ |
|------|-------|
| **WhatsApp** | ×¡×¨×™×§×”, ×¨×™×©×•× ×”×•×¦××•×ª, ××™×©×•×¨×™×, ×¡×™×•×•×’, ×’×¨×¤×™×, ×©×™×—×•×ª ×¢× ×’×“×™ |
| **Desktop** | ×¦×¤×™×™×” ×‘× ×ª×•× ×™×, ×’×¨×¤×™×, ×“×•×—×•×ª - READ ONLY |

---

## ğŸ”„ ×¢×“×›×•×Ÿ ×—×©×•×‘: ×¡×“×¨ ×©×œ×‘×™× ×—×“×© (31 ×“×¦××‘×¨ 2025)

**××§×•×¨:** ×¤×’×™×©×” ×¢× ×’×“×™

| ×œ×¤× ×™ | ××—×¨×™ |
|------|------|
| Phase 3: Budget | Phase 3: Goals |
| Phase 4: Goals | Phase 4: Budget |

> **×”×¡×™×‘×”:** ×¦×¨×™×š ×œ×“×¢×ª ××ª ×”×™×¢×“×™× ×œ×¤× ×™ ×©×‘×•× ×™× ×ª×§×¦×™×‘ ×©×ª×•××š ×‘×”×!

---

## ğŸ¯ ×§×•×¨×œ×¦×™×”: ×©×œ×‘×™ ×”××•×¦×¨ â†” ××¦×‘ ×”×¤×™×ª×•×—

### Phase 1: Reflection (×©×™×§×•×£ ×¢×‘×¨) - âœ… ××•×©×œ×
**××˜×¨×”:** ×”×‘× ×ª ×“×¤×•×¡×™ ×”×•×¦××” ×”×™×¡×˜×•×¨×™×™× (3-6 ×—×•×“×©×™×)

| ×¤×™×¦'×¨ | ×¡×˜×˜×•×¡ | ××™×¤×”? |
|-------|--------|------|
| Onboarding via WhatsApp | âœ… | `onboarding-flow.ts` |
| AI parser ×œ×ª×©×•×‘×•×ª | âœ… | `parseOnboardingDataWithAI()` |
| Reflection Wizard (web) | âœ… | `/reflection` - 6 ×©×œ×‘×™× |
| user_baselines | âœ… | ×˜×‘×œ×” ×‘-DB |
| user_financial_profile | âœ… | ×˜×‘×œ×” ×‘-DB |

### Phase 1.5: Document Scanning - âœ… **××•×©×œ×!** (31 ×“×¦××‘×¨ 2025)
**××˜×¨×”:** ×¡×¨×™×§×” ××•×˜×•××˜×™×ª ×©×œ ×“×•×—×•×ª ×‘× ×§/××©×¨××™ + ×¡×™×•×•×’ ×ª× ×•×¢×•×ª

| ×¤×™×¦'×¨ | ×¡×˜×˜×•×¡ | ××™×¤×”? |
|-------|--------|------|
| PDF Upload via WhatsApp | âœ… | `webhook/route.ts` |
| AI Document Analysis | âœ… | `document-prompts.ts` |
| Transaction Extraction | âœ… | OCR + GPT |
| **Classification Session** | âœ… | `phi-router.ts` |
| Period Tracking (6 months) | âœ… | `period-tracker.ts` |
| Missing Docs Request | âœ… | ××•×˜×•××˜×™ ××—×¨×™ ×¡×¨×™×§×” |
| **Income Categories (31)** | âœ… | `lib/finance/income-categories.ts` |
| **User Learning** | âœ… | `user_category_rules` table |
| **DB-based Cache** | âœ… | `classification_context` in users |
| **Credit Card Handling** | âœ… | `needs_credit_detail` status |
| **Chart Generation** | âœ… | Gemini `gemini-3-pro-image-preview` |
| **Help Command** | âœ… | ×¤×§×•×“×ª "×¢×–×¨×”" |
| **List Command** | âœ… | ×¤×§×•×“×ª "×¨×©×™××”" |

**×¤×§×•×“×•×ª ×–××™× ×•×ª:**
| ×¤×§×•×“×” | ×ª×•×¦××” |
|-------|-------|
| **×’×¨×£ ×”×•×¦××•×ª** / **×’×¨×£** | ×”×ª×¤×œ×’×•×ª ×”×•×¦××•×ª ğŸ’¸ |
| **×’×¨×£ ×”×›× ×¡×•×ª** | ×”×ª×¤×œ×’×•×ª ×”×›× ×¡×•×ª ğŸ’š |
| **×¢×–×¨×”** | ×¨×©×™××ª ×›×œ ×”×¤×§×•×“×•×ª |
| **×¨×©×™××”** | ×§×˜×’×•×¨×™×•×ª ×–××™× ×•×ª |

**Flow ××•×©×œ×:**
1. ××©×ª××© ×©×•×œ×— ××¡××š PDF
2. ×‘×•×˜ ×× ×ª×— ×•××¦×™×’: ×ª×§×•×¤×”, ×ª× ×•×¢×•×ª, ××¡××›×™× ×—×¡×¨×™×
3. ××©×ª××© ×™×›×•×œ: ×œ×©×œ×•×— ×¢×•×“ / ×œ×›×ª×•×‘ "× ××©×™×š"
4. ×¡×™×•×•×’ ×”×›× ×¡×•×ª â†’ ×¡×™×•×•×’ ×”×•×¦××•×ª
5. ×”×¦×¢×•×ª ×—×›××•×ª ××‘×•×¡×¡×•×ª ×œ××™×“×” ××”××©×ª××©
6. ××¤×©×¨×•×ª ×œ×™×¦×•×¨ ×’×¨×¤×™× ×‘×›×œ ×©×œ×‘

### Phase 2: Behavior (×”×ª× ×”×œ×•×ª ×•×”×¨×’×œ×™×) - âœ… **××•×©×œ×!**
**××˜×¨×”:** ×–×™×”×•×™ ×“×¤×•×¡×™ ×”×•×¦××” ×‘×¤×•×¢×œ (30+ ×™××™×)

| ×¤×™×¦'×¨ | ×¡×˜×˜×•×¡ | ××™×¤×”? |
|-------|--------|------|
| analyzeBehavior() | âœ… | `lib/analysis/behavior-analyzer.ts` |
| Cron ×™×•××™ 20:30 | âœ… | `api/cron/daily-summary` |
| Cron ×©×‘×•×¢×™ ×¨××©×•×Ÿ 09:00 | âœ… | `api/cron/weekly-summary` |
| behavior_insights ×˜×‘×œ×” | âœ… | Migration + RLS |
| AI Tips ××™×©×™×™× | âœ… | `generateAITip()` ×¢× GPT-4o-mini |
| ××¢×‘×¨ ××•×˜×• ×œ×©×œ×‘ 3 | âœ… | `checkReadyForBudget()` + `transitionToBudget()` |
| BehaviorDashboard | âœ… | × ×ª×•× ×™× ×××™×ª×™×™× ×-DB |
| SmartInsights | âœ… | ××•×©×š ×ª×•×‘× ×•×ª ×-DB |
| WhatsApp Handler ×œ×ª×•×‘× ×•×ª | âœ… | `handleAnalysisRequest()` |

### Phase 3: Goals (×™×¢×“×™× ×•××˜×¨×•×ª) - ğŸš€ **×”×‘× ×‘×ª×•×¨!** (×©×•× ×”!)
**××˜×¨×”:** ×”×’×“×¨×ª ×™×¢×“×™× ××™×©×™×™× ×•××©×¤×—×ª×™×™× **×™×—×“ ×¢× ×”×œ×§×•×—**

| ×¤×™×¦'×¨ | ×¡×˜×˜×•×¡ | ××™×¤×”? |
|-------|--------|------|
| ×“×£ `/goals` | â³ | ×¦×¨×™×š ×œ×¤×ª×— |
| Goals setting via WhatsApp | â³ | ×¦×¨×™×š ×œ×¤×ª×— |
| ×©× ×™ ×¡×•×’×™ ×™×¢×“×™× (××›×•×•×Ÿ/×›×œ×œ×™) | â³ | ×¦×¨×™×š ×œ×¤×ª×— |
| child_name support | âœ… | DB ready |
| GoalsQuickView | âœ… | Dashboard component |

**×¡×•×’×™ ×™×¢×“×™×:**
- **×™×¢×“ ××›×•×•×Ÿ** - ×¡×›×•× + ×ª××¨×™×š (×¨×›×‘ 80,000â‚ª ×‘×¢×•×“ ×©× ×ª×™×™×)
- **×™×¢×“ ×›×œ×œ×™** - ×©×™×¤×•×¨ ××¦×‘, ×”×§×˜× ×ª ×—×•×‘×•×ª

### Phase 4: Budget (×ª×§×¦×™×‘ ××•×˜×•××˜×™) - â³ ×‘×”××ª× ×” (×©×•× ×”!)
**××˜×¨×”:** ×™×¦×™×¨×ª ×ª×§×¦×™×‘ ×—×›× **××‘×•×¡×¡ ×™×¢×“×™×**

| ×¤×™×¦'×¨ | ×¡×˜×˜×•×¡ | ××™×¤×”? |
|-------|--------|------|
| ×“×£ `/budget` | â³ | ×¦×¨×™×š ×œ×¤×ª×— |
| generateBudgetFromHistory() | â³ | ×¦×¨×™×š ×œ×¤×ª×— |
| Budget based on Goals | â³ | ×¦×¨×™×š ×œ×¤×ª×— |
| S-curve visualization | â³ | ×¦×¨×™×š ×œ×¤×ª×— |
| ×”×ª×¨××•×ª ×—×¨×™×’×” | â³ | alerts_rules ×§×™×™× |

**×¤×¨××˜×¨×™× ×œ×ª×§×¦×™×‘ (××¤×’×™×©×” ×¢× ×’×“×™):**
1. ×××•×¦×¢ ×©×•×¨×ª ×”×•×¦××” (×œ×¤×™ ×©×•×¨×”, ×œ× ×§×˜×’×•×¨×™×”)
2. ×××•×¦×¢ ×—×•×“×©×™ (×-12 ×—×•×“×©×™×)
3. ×™×¢×“ (×©× ×§×‘×¢ ×™×—×“ ×¢× ×œ×§×•×—)
4. ×”××œ×¦×” (×©×œ ×’×“×™/AI)

**×”×ª×§×¦×™×‘ × ×‘× ×” ×‘×™×—×¡ ×œ:**
- ××¡×¤×¨ × ×¤×©×•×ª
- ×¡×•×’ ××’×•×¨×™×
- ×¨××ª ×”×›× ×¡×”
- ×’×•×‘×” ×”×ª×—×™×™×‘×•×™×•×ª
- ×”×•×¦××•×ª ××©×ª× ×•×ª
- ×”×•×¦××•×ª ×§×‘×•×¢×•×ª (×©××™× ×Ÿ ×”×ª×—×™×™×‘×•×™×•×ª)
- ×”×•×¦××•×ª ××™×•×—×“×•×ª

### Phase 5: Monitoring (×‘×§×¨×” ×¨×¦×™×¤×”) - â³ ×‘×”××ª× ×”
**××˜×¨×”:** ×œ×™×•×•×™ ××¨×•×š ×˜×•×•×—

| ×¤×™×¦'×¨ | ×¡×˜×˜×•×¡ | ××™×¤×”? |
|-------|--------|------|
| Dashboard 2.0 | âœ… | `/dashboard` |
| ×¡×¨×™×§×ª ×”×•×¦××•×ª | â³ | ×¦×¨×™×š ×œ×¤×ª×— |
| ×”×•×“×¢×•×ª ×¡×˜×˜×•×¡ ×™×¢×“×™× | â³ | ×¦×¨×™×š ×œ×¤×ª×— |
| ×“×•×—×•×ª ×—×•×“×©×™×™×/×©× ×ª×™×™× | â³ | ×¦×¨×™×š ×œ×¤×ª×— |
| ×”×ª×¨××•×ª ×—×›××•×ª | â³ | alerts_events ×§×™×™× |
| ×¡×™×›×•× ×©×‘×•×¢×™ WhatsApp | â³ | ×¦×¨×™×š ×œ×¤×ª×— |

---

## ğŸ›¡ï¸ ×©× ×™ ×¡×•×’×™ ×¨×©×ª×•×ª ×‘×™×˜×—×•×Ÿ (×—×“×©!)

| ×¡×•×’ | ×¤×™×¨×•×˜ |
|-----|-------|
| **×‘×™×˜×—×•×Ÿ ×¤×™× × ×¡×™** | ×§×¨×Ÿ ×—×™×¨×•× (3-6 ×—×•×“×©×™×), ×—×™×¡×›×•×Ÿ × ×–×™×œ |
| **×‘×™×˜×—×•×Ÿ ×‘×™×˜×•×—×™** | ×‘×™×˜×•×— ×—×™×™×, ×‘×¨×™××•×ª, ××•×‘×“×Ÿ ×›×•×©×¨ ×¢×‘×•×“×” |

---

## ğŸ”„ ×ª×”×œ×™×š ××§×‘×™×œ: ××™×—×•×“ ×”×œ×•×•××•×ª (×—×“×©!)

**Flow:**
1. ×–×™×”×•×™ ×”×œ×•×•××•×ª ×‘×“×•×—×•×ª ×”×‘× ×§
2. ×©××œ×”: "×¨×•×¦×” ×©×’×“×™ ×™×‘×“×•×§ ××¤×©×¨×•×ª ×œ××™×—×•×“?"
3. ×× ×›×Ÿ â†’ ×‘×§×©×ª ×“×•×— ×”×œ×•×•××•×ª
4. ×©×œ×™×—×” ×›×œ×™×“ ×œ×’×“×™ ×¢× ×›×œ ×”×¤×¨×˜×™×

---

## ğŸ”§ ××” × ×‘× ×” ×”×™×•× (31 ×“×¦××‘×¨ 2025)

### Classification System
1. âœ… **××¢×¨×›×ª ×§×˜×’×•×¨×™×•×ª ×”×›× ×¡×•×ª** - 31 ×§×˜×’×•×¨×™×•×ª ×‘-`income-categories.ts`
2. âœ… **User Learning** - ×œ×•××“ ××”××©×ª××© ×•××¦×™×¢ ×§×˜×’×•×¨×™×•×ª
3. âœ… **DB-based Cache** - ×‘××§×•× in-memory (×¤×•×ª×¨ infinite loop)
4. âœ… **Credit Card Handling** - ×¡×˜×˜×•×¡ `needs_credit_detail`
5. âœ… **Group Classification** - ×¡×™×•×•×’ ×§×‘×•×¦×” ×©×œ××” ×‘×¤×¢× ××—×ª

### Chart Generation
1. âœ… **Gemini Integration** - `gemini-3-pro-image-preview`
2. âœ… **Expense Chart** - ×¤×§×•×“×” "×’×¨×£ ×”×•×¦××•×ª"
3. âœ… **Income Chart** - ×¤×§×•×“×” "×’×¨×£ ×”×›× ×¡×•×ª"
4. âœ… **Phi Brand Design** - ×¦×‘×¢×™× ×•×˜×™×¤×•×’×¨×¤×™×” ××•×ª×××™×

### Commands
1. âœ… **"×¢×–×¨×”"** - ××¦×™×’ ××ª ×›×œ ×”×¤×§×•×“×•×ª
2. âœ… **"×¨×©×™××”"** - ××¦×™×’ ×§×˜×’×•×¨×™×•×ª ×–××™× ×•×ª
3. âœ… **"×’×¨×£ ×”×•×¦××•×ª"** - ×”×ª×¤×œ×’×•×ª ×”×•×¦××•×ª
4. âœ… **"×’×¨×£ ×”×›× ×¡×•×ª"** - ×”×ª×¤×œ×’×•×ª ×”×›× ×¡×•×ª

### Bug Fixes
1. âœ… ×ª×™×§×•×Ÿ: ×¡×™×•×•×’ ×§×‘×•×¦×” ×©×œ××” (×œ× ×¨×§ ×ª× ×•×¢×” ××—×ª)
2. âœ… ×ª×™×§×•×Ÿ: loadContext ×œ× ××•×’×“×¨ ×‘-webhook
3. âœ… ×ª×™×§×•×Ÿ: ×”×¤×¨×“×” ×‘×™×Ÿ ×’×¨×£ ×”×•×¦××•×ª/×”×›× ×¡×•×ª
4. âœ… ×ª×™×§×•×Ÿ: infinite loop ×‘×ª× ×•×¢×•×ª ××©×¨××™

---

## ğŸ“‹ ××” ×”×œ××”?

### Priority 1: Phase 3 - Goals ğŸš€ (×©×•× ×”!)
1. [ ] ×“×£ `/goals` ×¢× ×”×’×“×¨×ª ×™×¢×“×™×
2. [ ] Goals flow via WhatsApp
3. [ ] ×¡×•×’×™ ×™×¢×“×™×: ××›×•×•×Ÿ / ×›×œ×œ×™
4. [ ] ×—×™×‘×•×¨ ×™×¢×“×™× ×œ×ª×§×¦×™×‘

### Priority 2: Phase 4 - Budget (××—×¨×™ Goals!)
1. [ ] ×“×£ `/budget` ×¢× AI-generated budget
2. [ ] `generateBudgetFromHistory()` - ×ª×§×¦×™×‘ ××•×˜×•××˜×™ ×-AI
3. [ ] Budget based on Goals + 4 parameters
4. [ ] S-curve visualization
5. [ ] ×”×ª×¨××•×ª ×—×¨×™×’×” via WhatsApp

### Priority 3: Parallel - Loan Consolidation
1. [ ] ×–×™×”×•×™ ×”×œ×•×•××•×ª ×‘×“×•×—×•×ª
2. [ ] ×©××œ×” ×¢×œ ××™×—×•×“
3. [ ] ×œ×™×“ ×œ×’×“×™ ×¢× ×¤×¨×˜×™×

---

## ğŸ“ ×§×‘×¦×™× ××¨×›×–×™×™×

### WhatsApp Bot (Updated!)
```
app/api/wa/webhook/route.ts          - Main webhook handler
lib/conversation/phi-router.ts       - ğŸ”¥ MAIN ROUTER (classification, charts, commands)
lib/finance/categories.ts            - Expense categories (140+)
lib/finance/income-categories.ts     - ğŸ†• Income categories (31)
lib/ai/gemini-image-client.ts        - ğŸ†• Gemini chart generation
lib/ai/chart-prompts.ts              - ğŸ†• Chart prompt templates
lib/documents/period-tracker.ts      - 6-month coverage tracking
```

### Dashboard (View-Only)
```
app/dashboard/page.tsx              - Main dashboard
components/dashboard/
  â”œâ”€â”€ FinancialOverview.tsx
  â”œâ”€â”€ DebtVsAssets.tsx
  â”œâ”€â”€ SmartInsights.tsx
  â”œâ”€â”€ PhaseProgress.tsx
  â””â”€â”€ GoalsQuickView.tsx
```

---

## ğŸ¨ ×¢×™×¦×•×‘ ×•-Branding

### Phi Color Palette (Nord-inspired)
```css
--phi-dark: #2E3440;      /* Primary dark */
--phi-gold: #A96B48;      /* Accent gold */
--phi-mint: #8FBCBB;      /* Success mint */
--phi-bg: #ECEFF4;        /* Background */
--phi-coral: #D08770;     /* Highlight coral */
```

### Typography
- Headers: Inter
- Body: Heebo (×¢×‘×¨×™×ª)
- Ï† Symbol: Georgia, serif

---

## âš ï¸ ×‘×¢×™×•×ª ×™×“×•×¢×•×ª

| ×‘×¢×™×” | ×¡×˜×˜×•×¡ |
|------|--------|
| ~~Infinite loop ×‘×ª× ×•×¢×•×ª ××©×¨××™~~ | âœ… ×ª×•×§×Ÿ |
| ~~loadContext ×œ× ××•×’×“×¨~~ | âœ… ×ª×•×§×Ÿ |
| ~~×’×¨×£ ×”×›× ×¡×•×ª ××—×–×™×¨ ×”×•×¦××•×ª~~ | âœ… ×ª×•×§×Ÿ |

××™×Ÿ ×‘×¢×™×•×ª ×™×“×•×¢×•×ª ×›×¨×’×¢! ğŸ‰

---

**×¢×“×›×•×Ÿ ××—×¨×•×Ÿ:** 31 ×‘×“×¦××‘×¨ 2025 - ×©×™× ×•×™ ×¡×“×¨ ×©×œ×‘×™×: Goals â†’ Budget ğŸ¯Ï†
